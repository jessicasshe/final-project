#**Learning how to create a pop up window**
videos used: https://www.youtube.com/watch?v=qtFohSvMPak , https://www.youtube.com/watch?v=ffVY6HGtxH8&list=PLv1XiDDk9Y4carvS-wQUERCBXiR-kM9sw&index=2
- create a button and design it how you like
- add an action to the button
- make sure to have imported JOption so you do not have any errors

**Making a streak**
https://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html   - api tutorial
use this for keeping the date for the streak: https://docs.oracle.com/javase/tutorial/datetime/index.html?utm_
  - oracle or netbeans site are good for learning how to use different gui features
  - make sure to browse
timer class: https://youtu.be/LRzf2JChudM?si=865r3pVi4qvb_02B , https://www.youtube.com/watch?v=HR8rr73GrgY (changed my mind about adding a timer)
  - best to allow the user to close the popup in their own time than to figure how to time one.

DATE CLASS: https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html?utm
  - learnt that you can use the predefined dates that come with java to keep track of things
  - optimal for streak
    - so we know whether or not the streak has been broken


//attemt at class, worked but doesn't update directly to the users specifically


import java.awt.Component;
import java.time.LocalDate;
import java.util.prefs.Preferences;
import javax.swing.JOptionPane;

/**
 *
 * @author User
 */
public class StreakTracker {
    
    private static final Preferences PREFS = Preferences.userNodeForPackage(StreakTracker.class);
    private static final String KEY_STREAK = "streak";
    private static final String KEY_LAST_COMPLETED = "lastCompletedDate"; // yyyy-mm-dd
    private static final String KEY_LAST_PROMPT = "lastPromptDate";
    
    private StreakTracker() { }
    
    public static int getStreak(){
        return PREFS.getInt(KEY_STREAK, 0);
    }
    
    public static void promptIfNeeded(Component parent){
        LocalDate today = LocalDate.now();
        
        LocalDate lastPrompt = parseDate(PREFS.get(KEY_LAST_PROMPT,null));
        //for if they have already asked today
        if (today.equals(lastPrompt)){
            return;
        }
        
        int streak = PREFS.getInt(KEY_STREAK, 0);
        LocalDate lastCompleted = parseDate(PREFS.get(KEY_LAST_COMPLETED, null));
        //streak missed more that one day
        
        if (streak > 0 && lastCompleted != null && !lastCompleted.equals(today) && !lastCompleted.equals(today.minusDays(1))){
            streak = 0;
            PREFS.putInt(KEY_STREAK, 0);
        }
        
        int choice = JOptionPane.showConfirmDialog(parent, "Have you read your book today??", "Book Streak", JOptionPane.YES_NO_CANCEL_OPTION, JOptionPane.QUESTION_MESSAGE);
        
        //ale prompted tdy mark
        PREFS.put(KEY_LAST_PROMPT, today.toString());
        
        if (choice == JOptionPane.YES_OPTION){
            int newStreak = computeNewStreak(streak, lastCompleted, today);
            PREFS.putInt(KEY_STREAK, newStreak);
            PREFS.put(KEY_LAST_COMPLETED, today.toString());
            
            JOptionPane.showMessageDialog(parent, "Great!!! Your current streak is "+newStreak+" day "+(newStreak == 1 ? "" : "s")+".", "Book Streak", JOptionPane.INFORMATION_MESSAGE );
        } else {
            //closing also counts as saying no
            int oldStreak = streak;
            PREFS.putInt(KEY_STREAK, 0);
            PREFS.remove(KEY_LAST_COMPLETED);
            
            JOptionPane.showMessageDialog(parent, (oldStreak > 0)? "Streak lost! Old streak: "+oldStreak+" day"+(oldStreak == 1 ? "" : "s")+".":" Streak is 0.", "Book Streak", JOptionPane.WARNING_MESSAGE);
        }
    }
    
    private static int computeNewStreak(int currentStreak, LocalDate lastCompleted, LocalDate today){
        if (lastCompleted == null){
            return 1;
        }
        if (lastCompleted.equals(today)){
            return currentStreak; //alr counted tdy
        }
        if (lastCompleted.equals(today.minusDays(1))){ //the day after, consecutive day
            return currentStreak + 1;
        }
        
        return 1;//restart
    }
    
    private static LocalDate parseDate(String s){
        if (s == null || s.isBlank()){
            return null;
        }
        try{
            return LocalDate.parse(s);
        }catch (Exception ex){
            return null;
        }
    }
    
}

